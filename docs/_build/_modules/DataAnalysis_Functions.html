
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>DataAnalysis_Functions &#8212; Assignment 2 1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for DataAnalysis_Functions</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Fri Nov 15 15:21:22 2019</span>

<span class="sd">@author: riddaali</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">xport</span>


<div class="viewcode-block" id="readFile"><a class="viewcode-back" href="../DataAnalysis_Functions.html#DataAnalysis_Functions.readFile">[docs]</a><span class="k">def</span> <span class="nf">readFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Creating this &quot;readFile()&quot; function to read the csv files. </span>
<span class="sd">    It takes the file name as argument.</span>
<span class="sd">    </span>
<span class="sd">    1) Reading the BRFSS 2018 data: https://www.cdc.gov/brfss/annual_data/annual_2018.html</span>
<span class="sd">    Converting it from a &quot;*.xpt&quot; (XPORT) file to a dataframe.</span>
<span class="sd">    </span>
<span class="sd">    PLESAE NOTE: I COULD NOT SUBMIT THE XPORT (&#39;LLCP2018.XPT&#39;) FILE DUE TO ITS</span>
<span class="sd">    BIG SIZE (962 MB) SO IN ORDER TO EXECUTE THE FUNCTION BELOW, PLEASE UNZIP</span>
<span class="sd">    THE &#39;LLCP2018XPT.zip&#39; FILE.</span>
<span class="sd">    </span>
<span class="sd">    With the help of documentation available at: https://pypi.org/project/xport/</span>
<span class="sd">    </span>
<span class="sd">    2) Selecting features from the original dataframe by using the loc() function</span>
<span class="sd">    </span>
<span class="sd">    3) Renaming each column to improve its readability</span>
<span class="sd">    </span>
<span class="sd">    4) Converting each column into categorical variables</span>
<span class="sd">    </span>
<span class="sd">    5) Exporting the dataframe by saving it as a csv file</span>
<span class="sd">    </span>
<span class="sd">    :param [file_name]: [name of the file that includes the data]</span>
<span class="sd">    :return: [CSV file that has been created in the specified path]</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">xport</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
  
    <span class="c1"># Selecting variables (columns) from the original dataframe by using the loc() function</span>
    <span class="n">selectedColsDF</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;_RFBMI5&#39;</span><span class="p">,</span> <span class="s1">&#39;_EDUCAG&#39;</span><span class="p">,</span> <span class="s1">&#39;_INCOMG&#39;</span><span class="p">,</span> <span class="s1">&#39;EXERANY2&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;_AGEG5YR&#39;</span><span class="p">,</span> <span class="s1">&#39;SEX1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRNKANY5&#39;</span><span class="p">,</span> <span class="s1">&#39;_DRDXAR1&#39;</span><span class="p">]]</span>
    
    <span class="c1"># Renaming each column to improve its readability.</span>
    <span class="n">selectedColsDF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Overweight_Obese&#39;</span><span class="p">,</span> <span class="s1">&#39;Education_Level&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Income_Categories&#39;</span><span class="p">,</span> <span class="s1">&#39;Exercise&#39;</span><span class="p">,</span> <span class="s1">&#39;Age_Categories&#39;</span><span class="p">,</span> 
                              <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;Alcohol_Consumption&#39;</span><span class="p">,</span> <span class="s1">&#39;Arthritis&#39;</span><span class="p">]</span>
    
    <span class="c1"># Converting each column from object into categorical variables</span>
    <span class="c1"># Source used for guidance: https://pbpython.com/pandas_dtypes.html</span>
    <span class="k">for</span> <span class="n">eachCol</span> <span class="ow">in</span> <span class="n">selectedColsDF</span><span class="p">:</span>
        <span class="n">selectedColsDF</span><span class="p">[</span><span class="n">eachCol</span><span class="p">]</span> <span class="o">=</span> <span class="n">selectedColsDF</span><span class="p">[</span><span class="n">eachCol</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="c1">#print(selectedColsDF.dtypes)</span>

    
    <span class="c1"># Saving the dataframe into a csv file called &quot;BRFSS2018.csv&quot;</span>
    <span class="n">exportDF_csv</span> <span class="o">=</span> <span class="n">selectedColsDF</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;./BRFSS2018.csv&#39;</span><span class="p">,</span> 
                                         <span class="n">index</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

    <span class="k">return</span> <span class="n">exportDF_csv</span></div>





<div class="viewcode-block" id="dataCleaning"><a class="viewcode-back" href="../DataAnalysis_Functions.html#DataAnalysis_Functions.dataCleaning">[docs]</a><span class="k">def</span> <span class="nf">dataCleaning</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;  </span>
<span class="sd">    This function takes the dataframe as an arugment.</span>
<span class="sd">    </span>
<span class="sd">    1) Filtering missing and meaningless values (e.g. Don&#39;t know, refused, etc.)</span>
<span class="sd">       by using the loc technique.</span>
<span class="sd">    2) Replacing Feature values with their actual meaning by using dictionaries.</span>
<span class="sd">        </span>
<span class="sd">    :param [df]: [dataframe that will be used to carry out the data cleaning]</span>
<span class="sd">    :return: [cleaned (without NAs, meaningless values, renamed values) dataframe]</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Overweight_Obese&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Education_Level&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Income_Categories&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Exercise&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span> 
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Exercise&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age_Categories&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">14</span><span class="p">)</span> 
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)</span> 
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Alcohol_Consumption&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">)</span> 
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Alcohol_Consumption&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">)]</span>
    
    <span class="c1"># =========================================================================</span>
    <span class="c1"># Creating a copy of the BRFSS dataframe while removing all the missing </span>
    <span class="c1"># values (NaNs) to ensure that the modifications to the data will not be</span>
    <span class="c1"># reflected in the original dataframe</span>
    <span class="c1"># =========================================================================</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">gender_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s1">&#39;Female&#39;</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">k1</span><span class="p">,</span> <span class="n">v1</span> <span class="ow">in</span> <span class="n">gender_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Gender</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">overweight_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Yes&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k2</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">overweight_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Overweight_Obese</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k2</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">education_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;No_HighSchool_Graduate&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;HighSchool_Graduate&#39;</span><span class="p">,</span> 
                      <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Attended_College&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;College_Graduate&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k3</span><span class="p">,</span> <span class="n">v3</span> <span class="ow">in</span> <span class="n">education_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Education_Level</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k3</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">income_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;&lt;$15,000&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;$15,000_to_&lt;$25,000&#39;</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;$25,000_to_&lt;$35,000&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;$35,000_to_&lt;$50,000&#39;</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;$50,000&gt;=&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k4</span><span class="p">,</span> <span class="n">v4</span> <span class="ow">in</span> <span class="n">income_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Income_Categories</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k4</span><span class="p">,</span> <span class="n">v4</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">exercise_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k5</span><span class="p">,</span> <span class="n">v5</span> <span class="ow">in</span> <span class="n">exercise_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Exercise</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k5</span><span class="p">,</span> <span class="n">v5</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">age_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;18-24&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;25-29&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;30-34&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;35-39&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;40-44&#39;</span><span class="p">,</span>
                <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;45-49&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="s1">&#39;50-54&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="s1">&#39;55-59&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="s1">&#39;60-64&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;65-69&#39;</span><span class="p">,</span>
                <span class="mi">11</span><span class="p">:</span> <span class="s1">&#39;70-74&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="s1">&#39;75-79&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="s1">&#39;80&gt;=&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k6</span><span class="p">,</span> <span class="n">v6</span> <span class="ow">in</span> <span class="n">age_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Age_Categories</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k6</span><span class="p">,</span> <span class="n">v6</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">alcohol_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;No&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k7</span><span class="p">,</span> <span class="n">v7</span> <span class="ow">in</span> <span class="n">alcohol_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Alcohol_Consumption</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k7</span><span class="p">,</span> <span class="n">v7</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="n">arthritis_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Diagnosed&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Not_Diagnosed&#39;</span><span class="p">}</span>
    
    <span class="k">for</span> <span class="n">k8</span><span class="p">,</span> <span class="n">v8</span> <span class="ow">in</span> <span class="n">arthritis_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">df</span><span class="o">.</span><span class="n">Arthritis</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">k8</span><span class="p">,</span> <span class="n">v8</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    
    <span class="k">return</span> <span class="n">df</span></div>


    
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Assignment 2</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Ridda Ali.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>